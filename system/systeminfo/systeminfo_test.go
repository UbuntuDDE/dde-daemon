package systeminfo

import (
	"testing"

	. "github.com/smartystreets/goconvey/convey"
)

var xmlData string = `<?xml version="1.0" standalone="yes" ?>
<!-- generated by lshw- -->
<!-- GCC 8.3.0 -->
<!-- Linux 4.19.0-6-amd64 #1 SMP Uos 4.19.67-11eagle (2020-03-21) x86_64 -->
<!-- GNU libc 2 (glibc 2.28) -->
<list>
  <node id="memory" claimed="true" class="memory" handle="DMI:0034">
   <description>System Memory</description>
   <physid>34</physid>
   <slot>System board or motherboard</slot>
   <size units="bytes">3221225472</size>
   <hints>
    <hint name="icon" value="memory" />
   </hints>
    <node id="bank:0" claimed="true" class="memory" handle="DMI:0035">
     <description>SODIMM DDR3 Synchronous 1333 MHz (0.8 ns)</description>
     <product>EBJ40UG8BBU0-GN-F</product>
     <vendor>Elpida</vendor>
     <physid>0</physid>
     <serial>[REMOVED]</serial>
     <slot>ChannelA-DIMM0</slot>
     <size units="bytes">4294967296</size>
     <width units="bits">64</width>
     <clock units="Hz">1333000000</clock>
     <hints>
      <hint name="icon" value="memory" />
     </hints>
    </node>
    <node id="bank:1" claimed="true" class="memory" handle="DMI:0036">
     <description>SODIMM DDR3 Synchronous 1333 MHz (0.8 ns)</description>
     <product>M471B5773DH0-CK0</product>
     <vendor>Samsung</vendor>
     <physid>1</physid>
     <serial>[REMOVED]</serial>
     <slot>ChannelB-DIMM0</slot>
     <size units="bytes">2147483648</size>
     <width units="bits">64</width>
     <clock units="Hz">1333000000</clock>
     <hints>
      <hint name="icon" value="memory" />
     </hints>
    </node>
  </node>
</list>`

func Test_parseXml(t *testing.T) {
	Convey("parseXml", t, func(c C) {
		value, err := parseXml([]byte(xmlData))
		v := value.Size
		t.Log(v)
		c.So(v, ShouldEqual, uint64(3221225472))
		c.So(err, ShouldBeNil)
	})
}
